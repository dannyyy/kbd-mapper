const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-DIzbk_dI.js","assets/index-e2Sh7A6D.js","assets/index-Bjx_BcQ3.css","assets/svg2pdf.es.min-K2PxTj5y.js","assets/_commonjsHelpers-Cpj98o6Y.js"])))=>i.map(i=>d[i]);
import{u as T,a as $,_ as L,d as k,b as G}from"./index-e2Sh7A6D.js";function z(){const m=T(),y=$();function f(){const t=document.querySelector(".keyboard-renderer");if(!t)return null;const e=t.querySelectorAll("svg.keyboard-svg");if(e.length===0)return null;const r=y.currentTheme.colors.background,a=20;if(e.length===1){const u=e[0].cloneNode(!0);return E(u),P(u,r),u}let c=0,n=0;const i=20,o=30,l=[];e.forEach(u=>{const p=parseFloat(u.getAttribute("width")||"800"),w=parseFloat(u.getAttribute("height")||"400");l.push({w:p,h:w}),p>n&&(n=p),c+=w+o+a}),c+=i*2-a,n+=i*2;const s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("xmlns","http://www.w3.org/2000/svg"),s.setAttribute("width",String(n)),s.setAttribute("height",String(c)),s.setAttribute("viewBox",`0 0 ${n} ${c}`);const h=document.createElementNS("http://www.w3.org/2000/svg","rect");h.setAttribute("width",String(n)),h.setAttribute("height",String(c)),h.setAttribute("fill",r),s.appendChild(h);let d=i;const A=m.visibleLayers;return e.forEach((u,p)=>{const w=A[p];if(w){const v=document.createElementNS("http://www.w3.org/2000/svg","g");v.setAttribute("transform",`translate(${i}, ${d})`);const b=document.createElementNS("http://www.w3.org/2000/svg","circle");b.setAttribute("cx","6"),b.setAttribute("cy","12"),b.setAttribute("r","5"),b.setAttribute("fill",w.color),v.appendChild(b);const g=document.createElementNS("http://www.w3.org/2000/svg","text");g.setAttribute("x","18"),g.setAttribute("y","16"),g.setAttribute("font-size","14"),g.setAttribute("font-weight","600"),g.setAttribute("font-family",y.currentTheme.typography.fontFamily),g.setAttribute("fill",y.currentTheme.colors.legendColors.primary),g.textContent=w.name,v.appendChild(g),s.appendChild(v),d+=o}const S=u.cloneNode(!0);E(S);const R=l[p],x=document.createElementNS("http://www.w3.org/2000/svg","g");for(x.setAttribute("transform",`translate(${i}, ${d})`);S.firstChild;)x.appendChild(S.firstChild);s.appendChild(x),d+=R.h+a}),s}function E(t){t.querySelectorAll(".keycap.selected rect").forEach(()=>{}),t.querySelectorAll("[class]").forEach(e=>{e.removeAttribute("class")}),t.querySelectorAll('[style*="cursor"]').forEach(e=>{const r=e.getAttribute("style")||"";e.setAttribute("style",r.replace(/cursor:\s*pointer;?\s*/g,""))})}function P(t,e){const r=document.createElementNS("http://www.w3.org/2000/svg","rect"),a=t.getAttribute("viewBox");if(a){const[c,n,i,o]=a.split(/\s+/).map(Number);r.setAttribute("x",String(c)),r.setAttribute("y",String(n)),r.setAttribute("width",String(i)),r.setAttribute("height",String(o))}else r.setAttribute("width",t.getAttribute("width")||"100%"),r.setAttribute("height",t.getAttribute("height")||"100%");r.setAttribute("fill",e),t.insertBefore(r,t.firstChild)}function C(t){let r=new XMLSerializer().serializeToString(t);return r.startsWith("<?xml")||(r=`<?xml version="1.0" encoding="UTF-8"?>
`+r),r}async function N(){const t=f();if(!t)throw new Error("No SVG found to export");const e=C(t);G(e,`${m.project.name}.svg`,"image/svg+xml")}async function _(t){const e=f();if(!e)throw new Error("No SVG found to export");const r=C(e),a=parseFloat(e.getAttribute("width")||"800"),c=parseFloat(e.getAttribute("height")||"400"),n=document.createElement("canvas");n.width=a*t,n.height=c*t;const i=n.getContext("2d");i.scale(t,t);const o=new Image,l=new Blob([r],{type:"image/svg+xml;charset=utf-8"}),s=URL.createObjectURL(l);return new Promise((h,d)=>{o.onload=()=>{i.drawImage(o,0,0,a,c),URL.revokeObjectURL(s),n.toBlob(A=>{A?(k(A,`${m.project.name}.png`),h()):d(new Error("Failed to create PNG blob"))},"image/png")},o.onerror=()=>{URL.revokeObjectURL(s),d(new Error("Failed to load SVG for PNG export"))},o.src=s})}async function F(){const t=f();if(!t)throw new Error("No SVG found to export");const e=parseFloat(t.getAttribute("width")||"800"),r=parseFloat(t.getAttribute("height")||"400"),{jsPDF:a}=await L(async()=>{const{jsPDF:l}=await import("./jspdf.es.min-DIzbk_dI.js").then(s=>s.j);return{jsPDF:l}},__vite__mapDeps([0,1,2])),{svg2pdf:c}=await L(async()=>{const{svg2pdf:l}=await import("./svg2pdf.es.min-K2PxTj5y.js");return{svg2pdf:l}},__vite__mapDeps([3,4,0,1,2])),n=e>r,i=new a({orientation:n?"landscape":"portrait",unit:"pt",format:[e,r]}),o=document.createElement("div");o.style.position="absolute",o.style.left="-9999px",o.style.top="-9999px",o.appendChild(t),document.body.appendChild(o);try{await c(t,i,{x:0,y:0,width:e,height:r}),i.save(`${m.project.name}.pdf`)}finally{document.body.removeChild(o)}}async function j(t,e=2){switch(t){case"svg":return N();case"png":return _(e);case"pdf":return F()}}return{exportAs:j,prepareExportSvg:f,exportSvg:N,exportPng:_,exportPdf:F}}export{z as useExport};
